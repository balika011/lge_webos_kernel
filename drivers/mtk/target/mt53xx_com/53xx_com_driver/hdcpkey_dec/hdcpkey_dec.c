/*----------------------------------------------------------------------------*
 * Copyright Statement:                                                       *
 *                                                                            *
 *   This software/firmware and related documentation ("MediaTek Software")   *
 * are protected under international and related jurisdictions'copyright laws *
 * as unpublished works. The information contained herein is confidential and *
 * proprietary to MediaTek Inc. Without the prior written permission of       *
 * MediaTek Inc., any reproduction, modification, use or disclosure of        *
 * MediaTek Software, and information contained herein, in whole or in part,  *
 * shall be strictly prohibited.                                              *
 * MediaTek Inc. Copyright (C) 2010. All rights reserved.                     *
 *                                                                            *
 *   BY OPENING THIS FILE, RECEIVER HEREBY UNEQUIVOCALLY ACKNOWLEDGES AND     *
 * AGREES TO THE FOLLOWING:                                                   *
 *                                                                            *
 *   1)Any and all intellectual property rights (including without            *
 * limitation, patent, copyright, and trade secrets) in and to this           *
 * Software/firmware and related documentation ("MediaTek Software") shall    *
 * remain the exclusive property of MediaTek Inc. Any and all intellectual    *
 * property rights (including without limitation, patent, copyright, and      *
 * trade secrets) in and to any modifications and derivatives to MediaTek     *
 * Software, whoever made, shall also remain the exclusive property of        *
 * MediaTek Inc.  Nothing herein shall be construed as any transfer of any    *
 * title to any intellectual property right in MediaTek Software to Receiver. *
 *                                                                            *
 *   2)This MediaTek Software Receiver received from MediaTek Inc. and/or its *
 * representatives is provided to Receiver on an "AS IS" basis only.          *
 * MediaTek Inc. expressly disclaims all warranties, expressed or implied,    *
 * including but not limited to any implied warranties of merchantability,    *
 * non-infringement and fitness for a particular purpose and any warranties   *
 * arising out of course of performance, course of dealing or usage of trade. *
 * MediaTek Inc. does not provide any warranty whatsoever with respect to the *
 * software of any third party which may be used by, incorporated in, or      *
 * supplied with the MediaTek Software, and Receiver agrees to look only to   *
 * such third parties for any warranty claim relating thereto.  Receiver      *
 * expressly acknowledges that it is Receiver's sole responsibility to obtain *
 * from any third party all proper licenses contained in or delivered with    *
 * MediaTek Software.  MediaTek is not responsible for any MediaTek Software  *
 * releases made to Receiver's specifications or to conform to a particular   *
 * standard or open forum.                                                    *
 *                                                                            *
 *   3)Receiver further acknowledge that Receiver may, either presently       *
 * and/or in the future, instruct MediaTek Inc. to assist it in the           *
 * development and the implementation, in accordance with Receiver's designs, *
 * of certain softwares relating to Receiver's product(s) (the "Services").   *
 * Except as may be otherwise agreed to in writing, no warranties of any      *
 * kind, whether express or implied, are given by MediaTek Inc. with respect  *
 * to the Services provided, and the Services are provided on an "AS IS"      *
 * basis. Receiver further acknowledges that the Services may contain errors  *
 * that testing is important and it is solely responsible for fully testing   *
 * the Services and/or derivatives thereof before they are used, sublicensed  *
 * or distributed. Should there be any third party action brought against     *
 * MediaTek Inc. arising out of or relating to the Services, Receiver agree   *
 * to fully indemnify and hold MediaTek Inc. harmless.  If the parties        *
 * mutually agree to enter into or continue a business relationship or other  *
 * arrangement, the terms and conditions set forth herein shall remain        *
 * effective and, unless explicitly stated otherwise, shall prevail in the    *
 * event of a conflict in the terms in any agreements entered into between    *
 * the parties.                                                               *
 *                                                                            *
 *   4)Receiver's sole and exclusive remedy and MediaTek Inc.'s entire and    *
 * cumulative liability with respect to MediaTek Software released hereunder  *
 * will be, at MediaTek Inc.'s sole discretion, to replace or revise the      *
 * MediaTek Software at issue.                                                *
 *                                                                            *
 *   5)The transaction contemplated hereunder shall be construed in           *
 * accordance with the laws of Singapore, excluding its conflict of laws      *
 * principles.  Any disputes, controversies or claims arising thereof and     *
 * related thereto shall be settled via arbitration in Singapore, under the   *
 * then current rules of the International Chamber of Commerce (ICC).  The    *
 * arbitration shall be conducted in English. The awards of the arbitration   *
 * shall be final and binding upon both parties and shall be entered and      *
 * enforceable in any court of competent jurisdiction.                        *
 *---------------------------------------------------------------------------*/

/*****************************************************************************
 *
 * Filename:
 * ---------
 *   $Workfile: mtk_edid.h
 *
 * Project:
 * --------
 *   MT5890
 *
 * Description:
 * ------------
 *   software descrypt HDCP 2.2 and 1.4 key
 *   
 * Author:
 * -------
 *   
 *
 * Unauthorized use, practice, perform, copy, distribution, reproduction,
 * or disclosure of this information in whole or in part is prohibited.
 *-----------------------------------------------------------------------------
 *
 * $Author: p4admin $
 * $Date: 2015/02/15 $
 * $RCSfile: hdcpkey_dec.c,v $
 * $Revision: #1 $
 *
 *---------------------------------------------------------------------------*/
#include "drvcust_if.h"
#include "hdcpkey_dec.h"
#include "eeprom_if.h"
#include "nptv_debug.h"
#include "hw_hdmi2.h"
#include "hw_vdoin.h"
#include "hw_pdwnc.h"
#include "util.h"
#include "x_chip_id.h"

UINT8 auhdcpprikey[PRIV_KEY_SIZE] = 
{
	0x07, 0x14, 0x01, 0x03, 0x1F, 0x5D, 0x34, 0x78, 0xCA, 0x31, 0xC3, 0xA3, 0x55, 0x4A, 0x9B, 0x24, 	
};

UINT8 u1MhlEdid[FLASH_MHL_2_0_EDID_SIZE]=
{
	0x00, 0xFF, 0xFF, 0xFF,  0xFF, 0xFF, 0xFF, 0x00,   0x36, 0x8B, 0x01, 0x00,  0x01, 0x01, 0x01, 0x01,
    0x01, 0x0F, 0x01, 0x03,  0x80, 0x3C, 0x22, 0x78,   0x0A, 0x0D, 0xC9, 0xA0,  0x57, 0x47, 0x98, 0x27,
    0x12, 0x48, 0x4C, 0xBF,  0xEF, 0x00, 0x01, 0x01,   0x01, 0x01, 0x01, 0x01,  0x01, 0x01, 0x01, 0x01,
    0x01, 0x01, 0x01, 0x01,  0x01, 0x01, 0x01, 0x1D,   0x00, 0x72, 0x51, 0xD0,  0x1E, 0x20, 0x6E, 0x28,
    0x55, 0x00, 0xC4, 0x8E,  0x21, 0x00, 0x00, 0x1E,   0x01, 0x1D, 0x80, 0x18,  0x71, 0x1C, 0x16, 0x20,
    0x58, 0x2C, 0x25, 0x00,  0xC4, 0x8E, 0x21, 0x00,   0x00, 0x9E, 0x00, 0x00,  0x00, 0xFC, 0x00, 0x4D,
    0x54, 0x4B, 0x20, 0x4C,  0x43, 0x44, 0x54, 0x56,   0x0A, 0x20, 0x20, 0x20,  0x00, 0x00, 0x00, 0xFD,
    0x00, 0x31, 0x4C, 0x0F,  0x50, 0x0E, 0x00, 0x0A,   0x20, 0x20, 0x20, 0x20,  0x20, 0x20, 0x01, 0x56,
    0x02, 0x03, 0x23, 0x74,  0x4B, 0x84, 0x10, 0x1F,   0x05, 0x13, 0x14, 0x01,  0x02, 0x11, 0x06, 0x15,
    0x26, 0x09, 0x7F, 0x03,  0x11, 0x7F, 0x18, 0x83,   0x01, 0x00, 0x00, 0x67,  0x03, 0x0C, 0x00, 0x10,
    0x00, 0xB8, 0x2D, 0x01,  0x1D, 0x00, 0xBC, 0x52,   0xD0, 0x1E, 0x20, 0xB8,  0x28, 0x55, 0x40, 0xC4,
    0x8E, 0x21, 0x00, 0x00,  0x1E, 0x01, 0x1D, 0x80,   0xD0, 0x72, 0x1C, 0x16,  0x20, 0x10, 0x2C, 0x25,
    0x80, 0xC4, 0x8E, 0x21,  0x00, 0x00, 0x9E, 0x8C,   0x0A, 0xD0, 0x8A, 0x20,  0xE0, 0x2D, 0x10, 0x10,
    0x3E, 0x96, 0x00, 0x13,  0x8E, 0x21, 0x00, 0x00,   0x18, 0x8C, 0x0A, 0xD0,  0x90, 0x20, 0x40, 0x31,
    0x20, 0x0C, 0x40, 0x55,  0x00, 0x13, 0x8E, 0x21,   0x00, 0x00, 0x18, 0x00,  0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,  0x00, 0x00, 0x00, 0x00,   0x00, 0x00, 0x00, 0x00,  0x00, 0x00, 0x00, 0x52
};

#ifdef CC_HDMI_2_0_HDCP_BIN

UINT8 u1Hdcp2Key[FLASH_HDMI_2_0_HDCP2_2_KEY_SIZE]=
{
	0xdc,0x13,0x38,0x43,0x2a,0x33,0x0a,0x2b,0xef,0x9c,0xa5,0x4f,0x12,0xa5,0x4e,0xc3,
	0xb3,0x31,0xa0,0x46,0xde,0x97,0xdb,0xdc,0xcd,0xf2,0xfb,0xda,0x77,0x69,0x8c,0xd5,
	0xe1,0x46,0x7c,0xc4,0x14,0x14,0xaf,0x88,0x46,0x75,0xb3,0x20,0x06,0x1d,0x8c,0x86,
	0xbd,0x78,0xcf,0x68,0xfc,0x1a,0xbd,0x8c,0xf9,0x13,0x3d,0x8b,0xff,0x10,0x81,0x93,
	0xb7,0x61,0xd8,0xa4,0x77,0x12,0x3f,0x51,0x35,0xdd,0x50,0xa9,0xa0,0x1a,0xe7,0xd3,
	0x71,0x49,0x30,0x13,0x4c,0x38,0x58,0xdd,0x2a,0xcf,0x8b,0xee,0xbf,0x4f,0x17,0xb8,
	0xa8,0x57,0xc7,0xbf,0x6d,0xbe,0x5f,0x6e,0xf4,0x6d,0xeb,0x37,0xec,0xce,0xa3,0x41,
	0x5a,0x39,0xd2,0xa7,0x63,0x6f,0x5c,0x2e,0x04,0xde,0x7a,0xfb,0x2c,0x32,0x64,0x29,
	0xac,0xb7,0x80,0xce,0x65,0x8e,0x0d,0x0b,0x92,0x4f,0xd4,0x05,0x0c,0xd3,0x23,0xcf,
	0xbf,0x10,0xd1,0x83,0x0d,0x2b,0x0d,0x68,0x6b,0x51,0xa9,0x8b,0x39,0x70,0x63,0x11,
	0x70,0x6d,0x8b,0x79,0xaf,0x70,0xd4,0x9a,0x15,0x02,0x46,0x84,0x79,0x88,0x33,0x43,
	0x83,0xec,0x0e,0x8b,0x8c,0x5f,0xc8,0x27,0x9d,0x4b,0x16,0x60,0x8a,0xdb,0x7f,0x75,
	0x06,0x3c,0xb0,0xb6,0x9f,0x4a,0x22,0x97,0x2b,0x82,0xd4,0x7c,0x80,0x72,0x89,0xd1,
	0xfa,0x37,0x68,0x08,0x2f,0xfe,0x76,0x9f,0x47,0x16,0x7a,0x06,0xeb,0xc0,0xcf,0xe8,
	0xba,0xe9,0x09,0x65,0x2c,0x61,0x5e,0x33,0x92,0xe2,0xae,0x2e,0x5f,0xc2,0x83,0x70,
	0xf4,0x95,0xa4,0xe1,0x86,0x93,0x42,0x0a,0x5a,0xa6,0x0a,0x7e,0xc2,0x79,0x10,0x49,
	0x6e,0x29,0x0c,0xe4,0xc4,0xb7,0x15,0xfc,0x4f,0x6d,0xff,0x1e,0xf8,0x16,0xaf,0x18,
	0x83,0xcb,0x2f,0xe8,0xa3,0x52,0x1d,0x97,0x95,0x7b,0x7f,0x16,0x2e,0xaf,0x43,0xd2,
	0xa3,0x0c,0x1a,0x1e,0x6d,0x1e,0x54,0x31,0xa2,0xca,0x92,0x1e,0x8c,0x5b,0xfd,0x84,
	0x05,0xba,0x4d,0xd6,0x3a,0x83,0xcc,0xc7,0x54,0x73,0xa3,0x48,0x52,0xc3,0x2a,0xee,
	0x3e,0x2d,0xc2,0x48,0x7b,0x9d,0xa5,0xda,0xbd,0xee,0xc2,0xcf,0x2e,0x14,0xc8,0x9d,
	0x61,0x2f,0xde,0xd1,0x28,0x65,0xae,0x29,0xbe,0x92,0xae,0x06,0xde,0x82,0xf8,0x4b,
	0x33,0xc4,0xd6,0xc5,0xc0,0xe0,0xc0,0x27,0x11,0x84,0x42,0xeb,0x33,0x1a,0xc9,0x62,
	0x5d,0x1b,0x00,0xdc,0x7a,0x64,0xff,0x6d,0xb1,0x6b,0x07,0xfe,0xd9,0xe4,0xa8,0x7c,
	0xca,0x1c,0xee,0xbd,0xa7,0x8a,0x17,0xe9,0x80,0xb9,0xbc,0x98,0x7f,0x80,0xda,0x1c,
	0x6a,0xee,0x47,0x42,0xc3,0xf1,0xab,0x6d,0x2f,0xf8,0x7e,0xb3,0x4b,0x59,0xda,0x45,
	0x09,0x81,0x6a,0xa9,0xc8,0x0f,0x52,0xe5,0xe3,0x61,0xdc,0xd7,0x8d,0x41,0xf7,0xd5,
	0xae,0xd5,0x04,0x95,0x29,0x8c,0x99,0xd9,0xa3,0xce,0x85,0xff,0xc7,0x19,0xb7,0x4b,
	0xad,0xde,0xf8,0x2c,0x8b,0x01,0x00,0x01,0x00,0x00,0x90,0x33,0x40,0xcb,0xf0,0xa1,
	0x42,0x13,0x50,0x1c,0x30,0x2f,0x20,0x8c,0xef,0xd6,0x51,0xcc,0x73,0xd5,0x37,0x46,
	0x15,0xb2,0x15,0xed,0xf9,0x88,0x4e,0xc7,0x8c,0x17,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x6c,0x73,0xff,
	0x90,0xa4,0x1d,0x3e,0x71,0x60,0x2a,0xf3,0x05,0x6b,0x73,0x48,0x9f,0x63,0x70,0xc6,
	0xb6,0x99,0xc0,0x0c,0x63,0x84,0x72,0xc1,0x57,0x32,0xc3,0x09,0x73,0xe0,0x0b,0x45,
	0x0c,0x22,0xba,0xab,0xa2,0x9e,0xf1,0xfe,0x30,0x98,0x00,0x6a,0xe3,0xc7,0x27,0x93,
	0xdb,0xc4,0x5a,0xf0,0x10,0xcd,0x07,0x54,0x4e,0xb0,0xc4,0x1a,0x2a,0xc2,0x20,0x4f,
	0xc8,0x04,0xe9,0x58,0xc2,0x21,0x60,0x78,0x85,0x1e,0xcc,0xd0,0xfb,0x73,0x29,0xea,
	0x10,0xb6,0x32,0x9c,0xd8,0x34,0x5a,0x6a,0x04,0x91,0x2b,0xad,0xa9,0x29,0x59,0x55,
	0xe3,0x0a,0xfb,0x75,0x67,0x96,0x2c,0x20,0x96,0x12,0x80,0x74,0xa0,0x31,0xff,0xf5,
	0x0e,0x93,0xf0,0x31,0xcd,0x92,0x1f,0x57,0x30,0xd1,0xea,0x5e,0x69,0xe7,0x4d,0xdf,
	0xeb,0xca,0x47,0x89,0x1b,0x1d,0x69,0x57,0x9e,0x97,0xe5,0x4d,0xa7,0xd4,0xc5,0x3a,
	0x5f,0xad,0x62,0xf9,0xf0,0x54,0xca,0x5f,0x10,0x0d,0x45,0x2c,0xbc,0x7e,0xd8,0x29,
	0xf3,0x70,0x6d,0x75,0x03,0xc8,0x2c,0x9f,0xf8,0x8a,0x75,0x98,0x21,0xa8,0x06,0xcc,
	0x97,0x6e,0xd4,0x42,0x41,0x53,0xc7,0x7e,0x46,0xac,0x17,0x6d,0x45,0x55,0x93,0xad,
	0x7a,0xab,0xd8,0xd8,0x30,0xc5,0x1a,0x46,0xfb,0x50,0x33,0x0c,0x7a,0xa1,0x11,0x97,
	0xc5,0x69,0x4d,0x2e,0x8a,0x7a,0x9b,0x60,0x31,0x26,0xaa,0x44,0xb7,0xe5,0x4c,0x36,
	0x0b,0xf1,0x43,0x90,0xec,0x7b,0x33,0xf1,0x96,0xc0,0xd5,0xa3,0x36,0xf0,0x76,0x45,
	0x5b,0x52,0x4d,0x29,0x4a,0x7f,0x4f,0x04,0xf7,0x19,0x6e,0x1c,0x78,0x60,0x6f,0xf9,
	0x90,0x30,0xad,0xc3,0x36,0x4c,0xb6,0x30,0xf4,0xc3,0x15,0x17,0x75,0xbf,0x6a,0x51,
	0x56,0xd2,0xe0,0x8b,0x89,0xa5,0x68,0xab,0xe6,0xc9,0xf6,0xca,0x00,0x21,0x23,0x83,
	0x06,0x0f,0xe5,0x46,0x15,0x24,0x47,0x05,0xcd,0x93,0xf7,0xba,0xc9,0xad,0x74,0xc1,
	0x68,0xe3,0xda,0x2c,0x74,0x5e,0xdf,0x05,0x00,0x90,0x51,0xab,0x8c,0x82,0xe1,0xbb,
	0x5d,0x58,0x29,0x5e,0xa7,0x2e,0x6b,0x66,0xbb,0x1b,0x9e,0x1e,0x6d,0xaa,0x1e,0xaa,
	0x24,0xbf,0x59,0xe8,0xd6,0xf6,0x47,0xf6,0xa1,0xe1,0x32,0x4e,0xcd,0x33,0xcd,0x9b,
	0x26,0x13,0xc5,0x31,0xc5,0x33,0x3a,0x7c,0xa8,0xc7,0xf5,0xa1,0xe6,0x88,0xc7,0x4f,
	0x7f,0xd3,0x4a,0x5a,0x79,0xf4,0xb5,0x54,0x76,0x66,0x6f,0x73,0x66,0x18,0xea,0xba,
	0xca,0x48,0xde,0xec,0x65,0x48,0x7d,0xf4,0xf9,0xf4,0xd3,0x28,0xab,0x9a,0xb0,0x31,
	0xee,0xc4,0xf3,0x5b,0xd5,0x0d,0xb7,0x33,0x3c,0x37,0x00,0x5c,0x6c,0xa3,0xf9,0xfb,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x50,0xb8,0xff
};

UINT8 u1Hdcp1Key[FLASH_HDMI_1_4_HDCP1_4_KEY_SIZE]=
{
	0x00 , 0x14 , 0x7c , 0xe6 , 0x2c , 0x37 , 0xf3 , 0xe8 , 0xa8 , 0x4d , 0x27 , 0x66 , 0xa8 , 0xd0 , 0x2f , 0x13,
    0x55 , 0x79 , 0x97 , 0xe7 , 0x87 , 0x37 , 0x18 , 0x04 , 0xd1 , 0x5f , 0x3b , 0x12 , 0x9f , 0x32 , 0xa4 , 0x6f,
    0x58 , 0x1c , 0x8a , 0xbc , 0x8c , 0x7f , 0xe3 , 0xcb , 0x81 , 0x9e , 0xb4 , 0x45 , 0x7c , 0x66 , 0x6a , 0xcc,
    0xdd , 0x5c , 0xc8 , 0x17 , 0xa3 , 0x90 , 0x43 , 0x91 , 0x8b , 0x01 , 0xf0 , 0x1d , 0xff , 0x8a , 0x1b , 0xde,
    0x94 , 0xd6 , 0xb6 , 0xf6 , 0x6d , 0x15 , 0x7b , 0x42 , 0x13 , 0xa2 , 0x1b , 0x04 , 0xb5 , 0xdd , 0x11 , 0xcc,
    0x42 , 0x28 , 0x66 , 0x65 , 0xf5 , 0x77 , 0xf1 , 0x65 , 0xc3 , 0x8c , 0x9b , 0x2c , 0xad , 0xb4 , 0xe9 , 0x7c,
    0xd1 , 0xbc , 0xd6 , 0x4a , 0x5d , 0xf7 , 0x45 , 0x3e , 0x2a , 0x22 , 0xec , 0xa8 , 0xdf , 0x68 , 0x54 , 0x57,
    0x5a , 0x10 , 0xc8 , 0x38 , 0x9f , 0x94 , 0xa0 , 0xa7 , 0xa0 , 0x71 , 0xa2 , 0x67 , 0x8e , 0x23 , 0xbd , 0x8d,
    0x63 , 0x89 , 0x0d , 0x01 , 0x91 , 0x97 , 0x4c , 0xba , 0x5c , 0x4d , 0x94 , 0x73 , 0x36 , 0x68 , 0x12 , 0x6c,
    0xe8 , 0xfa , 0xb1 , 0x51 , 0xc1 , 0x93 , 0xc6 , 0xce , 0x72 , 0x90 , 0xc1 , 0x6b , 0x4d , 0xf6 , 0x63 , 0x02,
    0xd3 , 0xa6 , 0x9b , 0x80 , 0x35 , 0xb6 , 0xa9 , 0xff , 0x8e , 0xfd , 0xd9 , 0x6f , 0x24 , 0xa6 , 0xdb , 0x4c,
    0xd2 , 0x0c , 0x0f , 0xcf , 0xcd , 0x1a , 0x19 , 0xe4 , 0x62 , 0x9c , 0x6d , 0x17 , 0x6b , 0x57 , 0x39 , 0xcb,
    0x6a , 0x0d , 0x80 , 0x75 , 0xfa , 0xf3 , 0x69 , 0x7d , 0x9f , 0x79 , 0xe3 , 0xc0 , 0x8b , 0x5a , 0xd2 , 0xa8,
    0xc9 , 0xd9 , 0x90 , 0x93 , 0xaa , 0xe6 , 0x1a , 0x1e , 0x17 , 0x93 , 0x03 , 0x2d , 0x43 , 0xc0 , 0xaf , 0x33,
    0x94 , 0x66 , 0xa9 , 0x18 , 0x55 , 0xcc , 0x22 , 0xf5 , 0x23 , 0xc8 , 0xc5 , 0x37 , 0xf1 , 0x81 , 0xd2 , 0x96,
    0xaf , 0x0a , 0x5a , 0xe5 , 0x8a , 0x13 , 0xef , 0x63 , 0x19 , 0x4c , 0xc6 , 0x3f , 0x6c , 0x9a , 0x7a , 0xb2,
    0xa6 , 0xd4 , 0x31 , 0x5a , 0x30 , 0x01 , 0x21 , 0xcd , 0xa2 , 0x86 , 0x74 , 0x04 , 0x46 , 0x3e , 0x38 , 0x08,
    0xe7 , 0x57 , 0xa7 , 0xb4 , 0x41 , 0x73 , 0x02 , 0x78 , 0x93 , 0x34 , 0x93 , 0xce , 0x93 , 0x5a , 0x46 , 0xd3,
    0x0a , 0x14 , 0xf7 , 0x61 , 0x03 , 0xb7 , 0x8f , 0x22 , 0xd2 , 0xf1 , 0x3a , 0x98 , 0xba , 0x28 , 0x62 , 0x53,
    0xca , 0x4c , 0x1d , 0x19 , 0xce , 0x49 , 0x87 , 0xf7 , 0xb5 , 0x26 , 0x00 , 0x00 , 0x00 , 0x00 , 0x00 , 0x00
};

UINT8 u1Hdmi2Edid[FLASH_HDMI_2_0_EDID_SIZE]=
{
#if 0
	0x00, 0xFF, 0xFF, 0xFF,  0xFF, 0xFF, 0xFF, 0x00,   0x4D, 0xD9, 0x02, 0xF3,	0x01, 0x01, 0x01, 0x01, 
	0x01, 0x16, 0x01, 0x03,  0x80, 0xBA, 0x69, 0x78,   0x0A, 0x0D, 0xC9, 0xA0,	0x57, 0x47, 0x98, 0x27, 
	0x12, 0x48, 0x4C, 0x21,  0x08, 0x00, 0x81, 0x80,   0x01, 0x01, 0x01, 0x01,	0x01, 0x01, 0x01, 0x01, 
	0x01, 0x01, 0x01, 0x01,  0x01, 0x01, 0x02, 0x3A,   0x80, 0x18, 0x71, 0x38,	0x2D, 0x40, 0x58, 0x2C, 
	0x45, 0x00, 0x44, 0x16,  0x74, 0x00, 0x00, 0x1E,   0x01, 0x1D, 0x00, 0x72,	0x51, 0xD0, 0x1E, 0x20, 
	0x6E, 0x28, 0x55, 0x00,  0x44, 0x16, 0x74, 0x00,   0x00, 0x1E, 0x00, 0x00,	0x00, 0xFC, 0x00, 0x53, 
	0x4F, 0x4E, 0x59, 0x20,  0x54, 0x56, 0x20, 0x20,   0x2A, 0x30, 0x37, 0x0A,	0x00, 0x00, 0x00, 0xFD, 
	0x00, 0x3A, 0x3E, 0x0E,  0x46, 0x0F, 0x00, 0x0A,   0x20, 0x20, 0x20, 0x20,	0x20, 0x20, 0x01, 0x04, 
	0x02, 0x03, 0x43, 0xF0,  0x50, 0x10, 0x05, 0x04,   0x20, 0x22, 0x3C, 0x3E,	0x03, 0x07, 0x02, 0x06, 
	0x01, 0x5F, 0x5E, 0x5D,  0x62, 0x26, 0x09, 0x07,   0x07, 0x15, 0x07, 0x50,	0x83, 0x01, 0x00, 0x00, 
	0x77, 0x03, 0x0C, 0x00,  0x20, 0x00, 0xB8, 0x3C,   0x2F, 0xD0, 0x89, 0x01,	0x02, 0x03, 0x04, 0x01, 
	0x40, 0x00, 0x0F, 0x10,  0x40, 0x50, 0x60, 0x46,   0xE2, 0x00, 0xFB, 0xE7,	0x0E, 0x61, 0x66, 0x65, 
	0x60, 0x6A, 0x6B, 0x8C,  0x0A, 0xD0, 0x8A, 0x20,   0xE0, 0x2D, 0x10, 0x10,	0x3E, 0x96, 0x00, 0x44, 
	0x16, 0x74, 0x00, 0x00,  0x18, 0x01, 0x1D, 0x80,   0x18, 0x71, 0x1C, 0x16,	0x20, 0x58, 0x2C, 0x25, 
	0x00, 0x44, 0x16, 0x74,  0x00, 0x00, 0x9E, 0x00,   0x00, 0x00, 0x00, 0x00,	0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00,  0x00, 0x00, 0x00, 0x00,   0x00, 0x00, 0x00, 0x00,	0x00, 0x00, 0x00, 0x7D
//hdmi2.0
	0x00, 0xFF, 0xFF, 0xFF,  0xFF, 0xFF, 0xFF, 0x00,   0x4D, 0xD9, 0x02, 0xF3,	0x01, 0x01, 0x01, 0x01, 
	0x01, 0x16, 0x01, 0x03,  0x80, 0xBA, 0x69, 0x78,   0x0A, 0x0D, 0xC9, 0xA0,	0x57, 0x47, 0x98, 0x27, 
	0x12, 0x48, 0x4C, 0x21,  0x08, 0x00, 0x81, 0x80,   0x01, 0x01, 0x01, 0x01,	0x01, 0x01, 0x01, 0x01, 
	0x01, 0x01, 0x01, 0x01,  0x01, 0x01, 0x02, 0x3A,   0x80, 0x18, 0x71, 0x38,	0x2D, 0x40, 0x58, 0x2C, 
	0x45, 0x00, 0x44, 0x16,  0x74, 0x00, 0x00, 0x1E,   0x01, 0x1D, 0x00, 0x72,	0x51, 0xD0, 0x1E, 0x20, 
	0x6E, 0x28, 0x55, 0x00,  0x44, 0x16, 0x74, 0x00,   0x00, 0x1E, 0x00, 0x00,	0x00, 0xFC, 0x00, 0x53, 
	0x4F, 0x4E, 0x59, 0x20,  0x54, 0x56, 0x20, 0x20,   0x2A, 0x30, 0x37, 0x0A,	0x00, 0x00, 0x00, 0xFD, 
	0x00, 0x3A, 0x3E, 0x0E,  0x46, 0x0F, 0x00, 0x0A,   0x20, 0x20, 0x20, 0x20,	0x20, 0x20, 0x01, 0x04, 
	0x02, 0x03, 0x46, 0xF0,  0x50, 0x10, 0x05, 0x66,   0x20, 0x22, 0x3C, 0x3E,	0x03, 0x07, 0x02, 0x06, 
	0x01, 0x5F, 0x5E, 0x5D,  0x62, 0x26, 0x09, 0x07,   0x07, 0x15, 0x07, 0x50,	0x77, 0x03, 0x0C, 0x00,
	0x10, 0x00, 0xF8, 0x3C,  0x2F, 0xD0, 0x89, 0x01,   0x02, 0x03, 0x04, 0x01,  0x40, 0x00, 0x0F, 0x10,
	0x40, 0x50, 0x60, 0x46,  0x67, 0xD8, 0x5D, 0xC4,   0x01, 0x78, 0xC8, 0x07,  0xE2, 0x00, 0xFB, 0xE6,   
	0x0E, 0x61, 0x65, 0x60,  0x6A, 0x6B, 0x8C, 0x0A,   0xD0, 0x8A, 0x20,  0xE0, 0x2D, 0x10, 0x10, 0x3E, 
	0x96, 0x00, 0x44,  0x16, 0x74, 0x00, 0x00, 0x18,   0x01, 0x1D, 0x80,  0x18, 0x71, 0x1C, 0x16, 0x20, 
	0x58, 0x2C, 0x25,  0x00, 0x44, 0x16, 0x74, 0x00,   0x00, 0x9E, 0x00,  0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00,  0x00, 0x00, 0x00, 0x00, 0x00,   0x00, 0x00, 0x00,  0x00, 0x00, 0x00, 0x00, 0x1B
#endif
	
	0x00,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0x00,0x34,0xA9,0xA4,0x10,0x00,0x00,0x00,0x00,
	0x00,0x16,0x01,0x03,0x80,0x46,0x27,0x78,0x2A,0x10,0xF5,0xA5,0x58,0x51,0xA3,0x25,
	0x12,0x50,0x54,0xBF,0xEF,0x80,0x95,0x00,0x81,0xC0,0x81,0x40,0x81,0x80,0xA9,0x40,
	0x90,0x40,0xB3,0x00,0x81,0x00,0x04,0x74,0x00,0x30,0xF2,0x70,0x5A,0x80,0xB0,0x58,
	0x8A,0x00,0xBA,0x89,0x21,0x00,0x00,0x1E,0x04,0x74,0x80,0x18,0x71,0x70,0x5A,0x80,
	0x58,0x2C,0x8A,0x00,0x5D,0x89,0x11,0x00,0x00,0x1E,0x00,0x00,0x00,0xFC,0x00,0x41,
	0x53,0x42,0x39,0x34,0x30,0x34,0x0A,0x20,0x20,0x20,0x20,0x20,0x00,0x00,0x00,0xFD,
	0x00,0x14,0x4D,0x18,0x8C,0x11,0x00,0x0A,0x20,0x20,0x20,0x20,0x20,0x20,0x01,0x37,
	0x02,0x03,0x4B,0xF1,0x4F,0x10,0x05,0x1F,0x14,0x20,0x04,0x13,0x03,0x02,0x5D,0x60,
	0x61,0x62,0x65,0x66,0x23,0x09,0x07,0x07,0x83,0x01,0x00,0x00,0x7F,0x03,0x0C,0x00,
	0x21,0x00,0xB8,0x3C,0xEF,0x00,0x00,0x00,0x00,0x80,0x8D,0x01,0x02,0x03,0x04,0x10,
	0x30,0x08,0x00,0x18,0x00,0x28,0x00,0x38,0x00,0x58,0x00,0x68,0x67,0xD8,0x5D,0xC4,
	0x01,0x78,0x80,0x03,0xE2,0x00,0x4B,0xE3,0x0F,0x00,0x48,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xF7

};

#if 0
void vHDMI20PromWriteToEep(void)
{
	INT32 i4Ret;
	UINT32 u4Offset;

	u4Offset = DRVCUST_OptGet(eHDMI20PROMNANDOffSet);
	if (u4Offset < 1)
	{
		Printf("no prom offset\n");
		
	}
	
    i4Ret = EEPHDMI20PROM_Write((UINT64)u4Offset, (UINT32)u1Prom, FLASH_HDMI_2_0_PROM_SIZE);
    if (i4Ret)
	{
		Printf(" read prom data  fail\n");
	}
}

void vHDMI20PramWriteToEep(void)
{
	INT32 i4Ret;
	UINT32 u4Offset;

	u4Offset = DRVCUST_OptGet(eHDMI20PRAMNANDOffSet);
	
	if (u4Offset < 1)
	{
		Printf("no pram offset\n");
		
	}
	
    i4Ret = EEPHDMI20PRAM_Write((UINT64)u4Offset, (UINT32)u1Pram, FLASH_HDMI_2_0_PRAM_SIZE);
    if (i4Ret)
	{
		Printf(" read pram data  fail\n");
	}
}
#endif

void vHDMI20HDCP2KeyWriteToEep(void)
{
	INT32 i4Ret;
	UINT32 u4Offset;

	u4Offset = DRVCUST_OptGet(eHDMI20HDCP22NANDOffSet);
	if (u4Offset < 1)
	{
		Printf("no hdcp2.2 offset\n");
		
	}
	
    // read hdcp from eeprom.
    i4Ret = EEPHDMI20HDCP22_Write((UINT64)u4Offset, (UINT32)u1Hdcp2Key, FLASH_HDMI_2_0_HDCP2_2_KEY_SIZE);
    if (i4Ret)
	{
		Printf(" read hdcp2x key fail\n");
	}
}

void vHDMI14HDCP1KeyWriteToEep(void)
{
	INT32 i4Ret;
	UINT32 u4Offset;

	u4Offset = DRVCUST_OptGet(eHDMI14HDCP14NANDOffSet);
	if (u4Offset < 1)
	{
		Printf("no hdcp1.4 offset\n");
		
	}
	
    // read hdcp from eeprom.
    i4Ret = EEPHDMI14HDCP14_Write((UINT64)u4Offset, (UINT32)u1Hdcp1Key, FLASH_HDMI_1_4_HDCP1_4_KEY_SIZE);
    if (i4Ret)
	{
		Printf(" read hdcp1x key fail\n");
	}
}

void vHDMI20EDIDWriteToEep(void)
{
	INT32 i4Ret;
	UINT32 u4Offset;

	u4Offset = DRVCUST_OptGet(eHDMI20EDIDNANDOffSet);
	Printf("_______u4Offset =0x%x_________________\n",u4Offset);
	
	if (u4Offset < 1)
	{
		Printf("no edid offset\n");
		
	}
	
    i4Ret = EEPHDMI20EDID_Write((UINT64)u4Offset, (UINT32)u1Hdmi2Edid, FLASH_HDMI_2_0_EDID_SIZE);
    if (i4Ret)
	{
		Printf(" write edid data  fail\n");
	}
}

void vMHL20EDIDWriteToEep(void)
{
	INT32 i4Ret;
	UINT32 u4Offset;

	u4Offset = DRVCUST_OptGet(eMHL20EDIDNANDOffsSet);
	
	if (u4Offset < 1)
	{
		Printf("no edid offset\n");
		
	}
	
    i4Ret = EEPMHL20EDID_Write((UINT64)u4Offset, (UINT32)u1MhlEdid, FLASH_MHL_2_0_EDID_SIZE);
    if (i4Ret)
	{
		Printf(" write edid data  fail\n");
	}
}


void vHDMI20PromReadFromEep(UINT8 *aupProm)
{
	INT32 i4Ret;
	UINT32 u4Offset;

	u4Offset = DRVCUST_OptGet(eHDMI20PROMNANDOffSet);
	if (u4Offset !=0)
	{
		Printf("no prom offset\n");
		
	}
	
    i4Ret = EEPHDMI20PROM_Read((UINT64)u4Offset, (UINT32)aupProm, FLASH_HDMI_2_0_PROM_SIZE);
    if (i4Ret)
	{
		Printf(" read prom data  fail\n");
	}
}

void vHDMI20PramReadFromEep(UINT8 *aupPram)
{
	INT32 i4Ret;
	UINT32 u4Offset;

	u4Offset = DRVCUST_OptGet(eHDMI20PRAMNANDOffSet);
	
	if (u4Offset < 1)
	{
		Printf("no pram offset\n");
		
	}
	
    i4Ret = EEPHDMI20PRAM_Read((UINT64)u4Offset, (UINT32)aupPram, FLASH_HDMI_2_0_PRAM_SIZE);
    if (i4Ret)
	{
		Printf(" read pram data  fail\n");
	}
}


void vHDCP2XKeyReadFromEep(UINT8 *aupHdcp2)
{
	INT32 i4Ret;
	UINT32 u4Offset;

	u4Offset = DRVCUST_OptGet(eHDMI20HDCP22NANDOffSet);
	if (u4Offset < 1)
	{
		Printf("no hdcp2.2 offset\n");
		
	}
    // read hdcp from eeprom.
    i4Ret = EEPHDMI20HDCP22_Read((UINT64)u4Offset, (UINT32)aupHdcp2, FLASH_HDMI_2_0_HDCP2_2_KEY_SIZE);
    if (i4Ret)
	{
		Printf(" read hdcp2x key fail\n");
	}
}

void vHDCP1XKeyReadFromEep(UINT8 *aupHdcp1)
{
	INT32 i4Ret;
	UINT32 u4Offset;

	u4Offset = DRVCUST_OptGet(eHDMI14HDCP14NANDOffSet);
	
	if (u4Offset < 1)
	{
		Printf("no edid offset\n");
		
	}
	
	i4Ret = EEPHDMI14HDCP14_Read((UINT64)u4Offset, (UINT32)aupHdcp1, FLASH_HDMI_1_4_HDCP1_4_KEY_SIZE);
	if (i4Ret)
	{
		Printf(" read edid data  fail\n");
	}

}



UINT8* bHDCP2XDecrypt(UINT8 *aupHdcp2)
{
	INT32 i;
    aes_context ctx;
	SHA1_CONTEXT_T rContext;
	UINT8 u1SHAResult[20];
	UINT8 ret=0/*,j=0*/;
	UINT8 buf[880];
	UINT8* Hdcp2Key;//[FLASH_HDMI_2_0_HDCP2_2_KEY_SIZE];

	Hdcp2Key =(UINT8 *)x_mem_alloc(FLASH_HDMI_2_0_HDCP2_2_KEY_SIZE);
	
	x_memset( buf, 0, 880);
	x_memset( Hdcp2Key, 0, FLASH_HDMI_2_0_HDCP2_2_KEY_SIZE);
	
	aes_setkey_dec( &ctx, auhdcpprikey, PRIV_KEY_SIZE * 8 );

	for ( i = 0 ; i < ENCRYPTION_SIZE ; i += 16)
	{
		aes_crypt_ecb( &ctx, AES_DECRYPT, aupHdcp2 + i, buf + i);
	}

    if(SHA1_Reset(&rContext) != shaSuccess)
    {
       Printf("%s Fail to reset.", __FUNCTION__);
        return (UINT8*)shaNull;
    }
	
    if(SHA1_Input(&rContext, buf + 16, 842) != shaSuccess)
    {
        Printf("%s Fail to input.", __FUNCTION__);
        return (UINT8*)shaStateError;
    }

    if(SHA1_Result(&rContext, u1SHAResult) != shaSuccess)
    {
        LOG(5, "%s Fail to get result.", __FUNCTION__);
        return (UINT8*)shaNull;
    }
	
	for(i=0;i<20;i++)
	{
		if(u1SHAResult[i] != buf[16+842 +i])
		{
			ret=1;
			break;
		}
	}

	if(!ret)
	{
		Printf("HDCP 2.2 key is correct\n");
	}
	else
	{
		Printf("HDCP 2.2 key is wrong\n");
	}

	x_memcpy(Hdcp2Key,buf + 538,320);
	
	x_memcpy(Hdcp2Key +320,buf + 16,5);

	x_memcpy(Hdcp2Key +325, buf + 21,131);
	
	x_memcpy(Hdcp2Key +325 +131, buf + 152,2);

	x_memcpy(Hdcp2Key +512,buf + 154,384);

    return Hdcp2Key;
}

#if 0
void vHDCP1XKeySet(UINT8 *key_mask)
{
	HDCP1_KEY_MASK_T key;//0xffc3
	UINT16 u2KeyMask=0;
	
	u2KeyMask = u1RegRead1B(KS_MASK_0);
	u2KeyMask = (u2KeyMask << 8) | u1RegRead1B(EPST_3);

	x_memcpy(&key,&u2KeyMask,sizeof(UINT16));
	
	key_mask[0] = key.M0    + 4* key.M1  + 16*key.M2  + 64*key.M3;
	key_mask[1] = 4*key.M0  + 8* key.M1  + 32*key.M2  + 128*key.M3;
	key_mask[2] = 2*key.M0  + 4* key.M1  + 8*key.M2   + 16*key.M3;
	key_mask[3] = 4*key.M4  + 8* key.M5  + 16*key.M6  + 32*key.M7;
	key_mask[4] = 8*key.M8  + 16* key.M9 + 32*key.M10 + 64*key.M11;
	key_mask[5] = key.M12   + 4* key.M13 + 64*key.M14 + 128*key.M15;
	key_mask[6] = 2*key.M12 + 8* key.M13 + 32*key.M14 + 128*key.M15;
}

unsigned int AddCrc(unsigned int crc,unsigned char b)
{
	unsigned int data;
	unsigned int crc_out;
	unsigned int cs;
	data =b;
	crc_out = crc ^ data;
	cs = (1 + (crc_out>>7) + (crc_out>>16)) & 0x0001;
	crc_out =((crc_out << 1) + cs) & 0x1ffff;

	return crc_out;
}

UINT8 bHDCP1XDecrypt(void)
{
	UINT8 key_mask[7]={0};
	UINT16 i,j;
	unsigned int CRC_result;
	HDCP1_KEY_INFO_T HdcpDecryKey;
	UINT8 aupHdcp1[EEPROM_HDMI_HDCP_1_4_KEY_SIZE + 8];

	x_memset( aupHdcp1, 0, (EEPROM_HDMI_HDCP_1_4_KEY_SIZE + 8));
	
	vHDCP1XKeyReadFromEep(aupHdcp1);
	
	vHDCP1XKeySet(key_mask);
	
	CRC_result = 0xa3c5;
	//CRC check
	for(i=0;i<328;i++)
	{
		if((i != 6) && (i!=7) && (i!=8))
		{
			CRC_result = AddCrc(CRC_result,aupHdcp1[i]);
		}
			
	}

	CRC_result = (CRC_result & 0xffff);

	for(i=0;i<5;i++)
	{
		HdcpDecryKey.u1BKSV[i] = aupHdcp1[1+i];
	}

	HdcpDecryKey.u1CRCValue[0] = aupHdcp1[6];
	HdcpDecryKey.u1CRCValue[1] = aupHdcp1[7];

	if(((CRC_result & 0xff) == HdcpDecryKey.u1CRCValue[0]) && (((CRC_result>>8) & 0xff) == HdcpDecryKey.u1CRCValue[1]))
	{
		Printf(" hdcp 1.4 key decrypt OK\n");
	}
	else
	{
		Printf("hdcp 1.4 key decrypt fail\n");
		return 1;
	}
	
	//decrypt
	for(i=0;i< 40;i++)
	{
		for(j=0;j<7;j++)
		{
			aupHdcp1[9 + i*7 + j] = aupHdcp1[9 + i*7 + j] ^ key_mask[j];
		}
	}

	x_memcpy(HdcpDecryKey.u1PrivateKey,aupHdcp1 + 9,280);

	vHDMILoadHdcp14KeyToSram(aupHdcp1);

	return 0;
}
#endif

void vHDMI20LoadPromToSram(void)
{
	UINT8 *Prom;
	UINT32 i=0;

	Prom = (UINT8 *)x_mem_alloc(FLASH_HDMI_2_0_PROM_SIZE);
	x_memset(Prom,0,FLASH_HDMI_2_0_PROM_SIZE);
	
	vHDMI20PromReadFromEep(Prom);

	vIO32Write1B(HDMI20_PROM_ADDR,0x0);

	for(i=0; i < FLASH_HDMI_2_0_PROM_SIZE; i++)
	{
		vIO32Write4B(HDMI20_PROM_DATA,Prom[i]);
		vUtDelay2us(1);
	}

	x_mem_free(Prom);
}


void vHDMI20LoadPramToSram(void)
{
	UINT8 *Pram;
	UINT32 i=0;

	Pram = (UINT8 *)x_mem_alloc(FLASH_HDMI_2_0_PRAM_SIZE);
	if(Pram == NULL)
	{
		Printf("Alloc memory fail\n");
	}
	
	x_memset(Pram,0,FLASH_HDMI_2_0_PRAM_SIZE);
	
	vHDMI20PramReadFromEep(Pram);

	vIO32Write4B(HDMI20_PRAM_ADDR,0x0);

	for(i=0; i < FLASH_HDMI_2_0_PRAM_SIZE; i++)
	{
		vIO32Write4B(HDMI20_PRAM_DATA,Pram[i]);
		vUtDelay2us(1);
	}

	x_mem_free(Pram);
}

void vHDMI20LoadHdcp2KeyToSram(void)
{
	UINT32 i=0;
	UINT8 *ptrHdcp2;
	//UINT8 *Hdcp2Key;
	if(!IS_SupportHDMI20())
	{
		return;
	}

	ptrHdcp2 = (UINT8 *)x_mem_alloc(1024);
	x_memset(ptrHdcp2,0,FLASH_HDMI_2_0_HDCP2_2_KEY_SIZE);

	vHDCP2XKeyReadFromEep(ptrHdcp2);

	//Hdcp2Key = bHDCP2XDecrypt(ptrHdcp2);
	
	vIO32Write4B(HDMI20_HDCP22_KEY0_ADDR,0x0);

	for(i=0; i < 512; i++)
	{
		vIO32Write4B(HDMI20_HDCP22_KEY0_DATA,ptrHdcp2[i]);
	}

	vIO32Write4B(HDMI20_HDCP22_KEY1_ADDR,0x0);
	for(i=0; i < 384; i++)
	{
		vIO32Write4B(HDMI20_HDCP22_KEY1_DATA,ptrHdcp2[i + 512]);
	}
	x_mem_free(ptrHdcp2);
}

void vHDMILoadHdcp14KeyToSram(void)
{
	UINT32 i=0;
	UINT8 *ptrHdcp1;
	
	ptrHdcp1 = (UINT8 *)x_mem_alloc(FLASH_HDMI_1_4_HDCP1_4_KEY_SIZE);
	x_memset(ptrHdcp1,0,FLASH_HDMI_1_4_HDCP1_4_KEY_SIZE);

	vHDCP1XKeyReadFromEep(ptrHdcp1);
	
	vIO32Write4B(HDMI14_HDCP14_KEY_ADDR,0x0);

	for(i=0; i < FLASH_HDMI_1_4_HDCP1_4_KEY_SIZE; i++)
	{
		vIO32Write4B(HDMI14_HDCP14_KEY_DATA,ptrHdcp1[i]);
		//vUtDelay2us(1);
	}
	
	vIO32WriteFldAlign(HDMI2_RX_EPST,0xc3ff,RG_HDMI2_REG_KEY_MASK);
	vIO32WriteFldAlign(HDMI2_RX_EPST,1,RG_HDMI2_REG_LD_KSV);
		
	x_mem_free(ptrHdcp1);
}

void vHDMI20LoadHdcpKey(void)
{
	UINT32 i=0;
	UINT8 *ptrHdcp2;
	UINT8 *Hdcp2Key;

	ptrHdcp2 = (UINT8 *)x_mem_alloc(FLASH_HDMI_2_0_HDCP2_2_KEY_SIZE);
	x_memset(ptrHdcp2,0,FLASH_HDMI_2_0_HDCP2_2_KEY_SIZE);

	Hdcp2Key = (UINT8 *)x_mem_alloc(FLASH_HDMI_2_0_HDCP2_2_KEY_SIZE);
	x_memset(Hdcp2Key,0,FLASH_HDMI_2_0_HDCP2_2_KEY_SIZE);

	vHDMI20LoadPromToSram();
	vHDMI20LoadPramToSram();
	vHDMILoadHdcp14KeyToSram();

	vHDCP2XKeyReadFromEep(ptrHdcp2);

	//Hdcp2Key = bHDCP2XDecrypt(ptrHdcp2);

	vIO32Write4B(HDMI20_HDCP22_KEY0_ADDR,0x0);

	for(i=0; i < 512; i++)
	{
		vIO32Write4B(HDMI20_HDCP22_KEY0_DATA,ptrHdcp2[i]);
	}

	vIO32Write4B(HDMI20_HDCP22_KEY1_ADDR,0x0);
	for(i=0; i < 384; i++)
	{
		vIO32Write4B(HDMI20_HDCP22_KEY1_DATA,ptrHdcp2[i + 512]);
	}
	x_mem_free(ptrHdcp2);
	x_mem_free(Hdcp2Key);
}

BOOL fgHDMI20CheckCap(void)
{
	return (BOOL)IS_SupportHDMI20();
}
#endif


