/** @addtogroup pers pers
 * @ingroup marlin
 * @{ */

/*
 * Nautilus version 4.2
 *
 * Any code and mechanism in this module may not be used
 * in any form without permissions.
 * Copyright 2007,2008,2009,2010,2011,2012 Sony Corporation.
 */
#ifndef PERS_TYPES_H
#define PERS_TYPES_H

#include "rsa_api.h"
#include "ns_defs.h"

/** @file */

/* Public */

/* Sony Connect */
#define L_NS_PERSNPS    "urn:marlin:organization:sony:connect:1-1:nemo:services:schemas:nemo-personalization-service"
#define L_NS_PERSCI     "urn:marlin:organization:sony:connect:1-1:nemo:services:schemas:nemo-personalization-service"
#define L_NS_PS         "urn:marlin:organization:sne:personalization-service:1-0-0"

/* NemoPersonalization */
#define L_MNPS_PROTOCOL                 "urn:marlin:organization:sne:personalization-service"
#define L_MNPS_PROFILE                  "base"
#define L_MNPS_VERSION_1                "1.0.0"
#define L_MNPS_VERSION_2                "2.0.0"
#define L_MNPS_ACTION_REQ_PERS_SETUP    "urn:marlin:organization:sony:connect:1-0:nemo-personalization-service:requestPersonalitySetup"
#define L_MNPS_ACTION_REQ_PERS          "urn:marlin:organization:sony:connect:1-0:nemo-personalization-service:requestPersonality"

/* Client Info  */
#define L_ROLE_ATTR_CTYPE               "personality"
#define L_ROLE_ATTR_CMANUFACTURER       "urn:marlin:organization:sony:connect"
#define L_ROLE_ATTR_CMODEL              "Windows PC Client"
#define L_ROLE_ATTR_CVERSIONMAJOR       "1"
#define L_ROLE_ATTR_CVERSIONMINOR       "0"
#define L_ROLE_ATTR_CVERSIONREVISION    "0"

typedef struct {
    binstr_t *sessionid;     /**< Unique session id (generated by the client) */
    binstr_t *nonce;         /**< Strong random number (generated by the server) */
    binstr_t *sessiondata;   /**< Considered as an opaque data block by the client */
    binstr_t *pubcert;       /**< Certificate for Public Key Ee (Ee: server's encryption certificate chain) */
    binstr_t *sigcert;       /**< Certificate for Public Key Es (Es: server's verification certificate chain) */
    u_int8_t  sessionkey[16]; /**< Session key generated by the client (used by the server to encrypt the NEMO Personality node in the subsequent message) */
    binstr_t *keytype;       /**< Key type (to be added to ChallengeResponse).Will be NULL for personalization 1.0.0*/
    binstr_t *bztoken;       /**< Business token (to be added to ChallengeResponse )*/
} pers_l_context_t;

#endif /* PERS_TYPES_H */

